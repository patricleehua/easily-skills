# Scripts 编写示例

## 1.示例：拉取视频（下载脚本）

### .1.1 HTTP 直链下载（mp4 URL）

```python
import requests, os

def download(url: str, out_path: str):
    os.makedirs(os.path.dirname(out_path), exist_ok=True)

    with requests.get(url, stream=True, timeout=60) as r:
        r.raise_for_status()
        with open(out_path, "wb") as f:
            for chunk in r.iter_content(1024 * 1024):
                if chunk:
                    f.write(chunk)

download("https://example.com/video.mp4", "./cache/video.mp4")
```

------

### .1.2 调用外部工具 yt-dlp 下载

适用于非直链视频网站：

```python
import subprocess, shutil

def require_cmd(cmd):
    if shutil.which(cmd) is None:
        raise SystemExit(f"未安装工具: {cmd}")

require_cmd("yt-dlp")

subprocess.run([
    "yt-dlp",
    "-o", "./cache/%(title)s.%(ext)s",
    "https://youtube.com/watch?v=xxxx"
])
```

------

## 2. 示例：ffmpeg 截图脚本

### 2.1 ffmpeg 命令示例

```bash
ffmpeg -ss 00:01:23.500 -i input.mp4 -frames:v 1 assets/frame_0001.jpg
```

------

### 2.2 Python 包装调用

```python
import subprocess

def screenshot(video, ts, out_file):
    subprocess.run([
        "ffmpeg", "-y",
        "-ss", ts,
        "-i", video,
        "-frames:v", "1",
        "-q:v", "2",
        out_file
    ], check=True)

screenshot("input.mp4", "00:00:05.000", "assets/frame1.jpg")
```

------

## 3. 示例：调用 OpenAI API（请求与获取结果）

OpenAI 官方建议使用 Responses API。

------

### 3.1 Python 调用示例

```python
import os
from openai import OpenAI

client = OpenAI(api_key=os.environ["OPENAI_API_KEY"])

resp = client.responses.create(
    model="gpt-5.2",
    input="请将材料整理成 Markdown 笔记。"
)

print(resp.output_text)
```

------

### 3.2 Node.js 调用示例

```js
import OpenAI from "openai";
import "dotenv/config";

const client = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });

const resp = await client.responses.create({
  model: "gpt-5.2",
  input: "请输出结构化 Markdown 笔记。"
});

console.log(resp.output_text);
```

